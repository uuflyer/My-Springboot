<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.mybatis.example.BlogMapper">
    <select id="selectBlog" resultMap="blog">
        SELECT
        blog.id as blog_id,
        blog.title as blog_title,
        blog.description as blog_description,
        blog.content as blog_conent,
        blog.updated_at as blog_updated_at,
        blog.created_at as blog_created_at,
        user.id as user_id,
        user.username as user_username,
        user.avatar as user_avatar,
        user.updated_at as user_updated_at,
        user.created_at as user_created_at
        FROM blog
        LEFT OUTER JOIN user
        ON blog.user_id = user.id
        <if test="user_id != null">
            WHERE blog.user_id = #{user_id}
        </if>
        limit ${offset}, #{limit}
    </select>
    <select id="countBlog" resultType="int">
        select count(*) from blog
        <if test="user_id != null">
            where user_id = #{user_id}
        </if>
    </select>
    <select id="selectBlogById" resultMap="blog">
        SELECT  blog.id             as blog_id,
                blog.title          as blog_title,
                blog.description    as blog_description,
                blog.content        as blog_content,
                blog.updated_at     as blog_updated_at,
                blog.created_at     as blog_created_at,
                user.id             as user_id,
                user.username       as user_username,
                user.avatar         as user_avatar,
                user.updated_at     as user_updated_at,
                user.created_at     as user_created_at,
        FROM blog
                LEFT OUTER JOIN user
                             ON blog.user_id = user.id
        WHERE blog.id = #{id}
    </select>
</mapper>